# جاب‌بورد (JobBoard)

این پروژه یک سامانه کاریابی بر پایه Django و PostgreSQL است که دو نقش اصلی (`کارفرما` و `کارجو`) دارد و قابلیت‌های فازهای ۱ تا ۴ به‌همراه بخش‌های امتیازی را پوشش می‌دهد.

## 1) قابلیت‌های اصلی پروژه

- ثبت‌نام/ورود نقش‌محور (کارفرما و کارجو)
- مدل کاربر سفارشی `accounts.User` (الزام فاز ۳)
- مدیریت سشن + لاگ‌گذاری در بخش‌های اصلی (الزام فاز ۳)
- فعال‌سازی حساب با ایمیل (الزام فاز ۴)
- فعال‌سازی پیامکی دمو (بخش امتیازی):
  - کاربر با دکمه `Send code` کد می‌گیرد
  - دکمه هنگام ارسال روی `Pending...` می‌رود
  - هر بار کد ۶ رقمی جدید و متفاوت تولید می‌شود
  - کد هم در لاگ فایل و هم در ترمینال چاپ می‌شود
- امکانات کارفرما:
  - ثبت/ویرایش آگهی شغلی
  - مشاهده درخواست‌ها
  - دانلود رزومه
  - تعیین زمان مصاحبه
  - رد درخواست
- امکانات کارجو:
  - آپلود رزومه
  - مشاهده/جستجوی آگهی‌ها
  - ارسال درخواست برای موقعیت شغلی
  - مشاهده وضعیت بررسی درخواست
  - ذخیره آگهی‌ها
  - ساخت هشدار شغلی
  - پیشنهاد شغل بر اساس مهارت/تحصیلات
- نوتیفیکیشن داخلی + لاگ دمو ایمیل/پیامک
- اسکریپت و دستور تولید دیتای تست

## 2) پوشش الزامات فایل PDF استاد

### فازبندی

- فاز ۱:
  - تعریف اپلیکیشن‌ها
  - مدل‌سازی و روابط
- فاز ۲:
  - پیاده‌سازی View / URL / Template / Form
  - ورود داده تستی
- فاز ۳:
  - Custom User
  - Session Management
  - Logging
- فاز ۴:
  - Manager ها
  - تایید کاربر با ایمیل
  - ارث‌بری Template ها
  - تکمیل گزارش
- امتیازی:
  - تایید با پیامک
  - تست‌ها

### الزامات سناریوی کاریابی

- سمت کارفرما:
  - ثبت‌نام/ورود: انجام شده
  - تعریف موقعیت با عنوان/حقوق/مزایا/قابلیت‌ها: انجام شده
  - لیست و ویرایش موقعیت‌ها: انجام شده
  - مشاهده رزومه‌ها: انجام شده
  - دریافت فایل رزومه: انجام شده
  - تعیین تاریخ مصاحبه: انجام شده
  - رد رزومه: انجام شده
- سمت کارجو:
  - ثبت‌نام/ورود: انجام شده
  - آپلود رزومه: انجام شده
  - مشاهده لیست و جزئیات موقعیت‌ها: انجام شده
  - جستجو بر اساس عنوان/حقوق/مهارت: انجام شده
  - ارسال رزومه برای شغل خاص: انجام شده
  - مشاهده نتیجه بررسی: انجام شده
- امتیازی:
  - ایمیل/پیامک نتیجه بررسی: انجام شده
  - پیشنهاد موقعیت شغلی متناسب با تحصیلات/تخصص: انجام شده

## 3) ساختار نهایی (بدون درخت تکراری فعال)

مسیر اجرای اصلی پروژه:

- `manage.py` در ریشه
- `jobboard/settings.py`
- اپ‌ها: `accounts/`, `jobs/`, `resumes/`

نسخه تکراری قدیمی از مسیر اجرایی حذف و به بکاپ منتقل شد:

- `/home/srz2003/Documents/jobboard_legacy_backup_2026-02-10/`

## 4) پیش‌نیازها

- Python 3.11+
- PostgreSQL 14+

نصب:

```bash
python3 -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt
```

## 5) تنظیمات `.env`

```env
DB_ENGINE=django.db.backends.postgresql
DB_NAME=jobboard_db
DB_USER=job_user
DB_PASSWORD=YourStrongPassHere
DB_HOST=localhost
DB_PORT=5432
SMS_ACTIVATION_TTL_SECONDS=600
```

## 6) راه‌اندازی PostgreSQL

فایل راهنما:

- `POSTGRES_SETUP.md`

نکته مهم:

- کاربر دیتابیس باید دسترسی `CREATEDB` داشته باشد تا تست‌های Django دیتابیس موقت بسازند.

## 7) اجرای پروژه

```bash
source .venv/bin/activate
set -a; source .env; set +a
python manage.py migrate
python manage.py createsuperuser
python manage.py runserver
```

آدرس:

- `http://127.0.0.1:8000/`

## 8) دیتای تست

```bash
scripts/insert_test_data.sh
```

یا با پارامتر سفارشی:

```bash
scripts/insert_test_data.sh qa QATest123! 4 8 4 2
```

خروجی یوزر/پسوردها در:

- `logs/test_users_<prefix>.txt`

## 9) جریان فعال‌سازی پیامکی (نسخه فعلی)

1. کاربر ثبت‌نام می‌کند (اکانت غیرفعال می‌ماند).
2. به مسیر `/accounts/sms-activate/` می‌رود.
3. نام کاربری را وارد می‌کند و `Send code` می‌زند.
4. دکمه موقتاً `Pending...` می‌شود.
5. کد جدید در ترمینال و `logs/sms_demo.log` ثبت می‌شود.
6. کاربر کد را وارد کرده و اکانت فعال می‌شود.

## 10) لاگ‌ها و خروجی‌های دمو

- لاگ اصلی: `logs/jobboard.log`
- لاگ SMS: `logs/sms_demo.log`
- لاگ‌های تفکیکی SMS: `logs/sms/*.jsonl`
- لاگ ایمیل: `logs/email_demo.log`
- خروجی دمو ایمیل: `logs/email/` و `logs/email_outbox.txt`

## 11) دستورات کنترل سلامت

```bash
set -a; source .env; set +a
python manage.py check
python manage.py makemigrations --check --dry-run
```

اگر `manage.py test` خطای `permission denied to create database` داد، دسترسی `CREATEDB` را برای کاربر PostgreSQL فعال کنید.
